(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{79:function(e,t,a){"use strict";a.r(t);var r=a(0),i=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"string-literals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#string-literals","aria-hidden":"true"}},[e._v("#")]),e._v(" String Literals")]),a("p",[e._v("In C, strings are arrays of characters terminated by an ASCII NUL character "),a("code",[e._v("'\\0'")]),e._v(".")]),a("blockquote",[a("p",[e._v("A string is a contiguous sequence of characters terminated by and including the first null character. The term multibyte string is sometimes used instead to emphasize special processing given to multibyte characters contained in the string or to avoid confusion with a wide string. A pointer to a string is a pointer to its initial (lowest addressed) character. The length of a string is the number of bytes preceding the null character and the value of a string is the sequence of the values of the contained characters, in order.")]),a("p",[e._v("–"),a("a",{attrs:{href:"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf#%5B%7B%22num%22%3A425%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C-27%2C816%2Cnull%5D",target:"_blank",rel:"noopener noreferrer"}},[e._v("C11 ISO/IEC 9899:2011 Definition of string")]),e._v(" (p 180)")])]),a("p",[e._v("You can define a string as a pointer to a char, initialised by a string literal. In this case, string literals are stored in a read only section of memory and are effectively constant.")]),a("p",[e._v('A string literal e.g. "Hello World!" has the type '),a("code",[e._v("const char*")]),e._v(" - a pointer to an array of chars which cannot be modified.")]),a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),a("span",{attrs:{class:"token keyword"}},[e._v("char")]),e._v(" "),a("span",{attrs:{class:"token operator"}},[e._v("*")]),e._v("str "),a("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{attrs:{class:"token string"}},[e._v('"Hello World!"')]),a("span",{attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])]),a("p",[e._v("After this statement "),a("code",[e._v("str")]),e._v(" is a pointer which points to an array of characters. These characters appear in the order of the string, and are followed by the null terminator character, '\\0' (note that we do not need to write this character down in the string literal—the compiler adds it for us for literals only).")]),a("p",[e._v("Each byte ("),a("code",[e._v("char")]),e._v(" is a type which is one byte wide) holds a numeric representation of the particular letter (as an ASCII code). The string is just a sequence of bytes in memory, the last of which has a numeric value of 0.")]),a("h2",{attrs:{id:"immutability"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#immutability","aria-hidden":"true"}},[e._v("#")]),e._v(" Immutability")]),a("p",[e._v("It is not possible to modify the characters pointed to by a string as defined by "),a("code",[e._v('const char *str = "Hello World!"')]),e._v(".")]),a("p",[e._v("In this case, assignment to "),a("code",[e._v("str[i]")]),e._v(" will result in a compiler error.")]),a("p",[e._v("If the "),a("code",[e._v("const")]),e._v(" modifier is not used in the variable declaration the code will still compile. Regardless of whether or not the variable is declared "),a("code",[e._v("const")]),e._v(", any attempt to modify the string will result in a segmentation fault crash.")]),a("p",[e._v("To enable compiler warnings for this type of mistake, compile with "),a("code",[e._v("-Wwrite-strings")]),e._v(" - this is not enabled by default with "),a("code",[e._v("-Wall")]),e._v(".")]),a("h3",{attrs:{id:"declare-string-literals-const"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#declare-string-literals-const","aria-hidden":"true"}},[e._v("#")]),e._v(" Declare String Literals Const")]),a("p",[e._v("Though many programmers are sloppy about "),a("code",[e._v("const")]),e._v(", as a matter of good practice "),a("strong",[e._v("string literals should be declared const")]),e._v(".")]),a("p",[e._v("The reason for the immutability of string literals is that the value is stored in a read-only section in the binary file and cannot be modified.")]),a("p",[e._v("If you compile to an assembly file (use the "),a("code",[e._v("-S")]),e._v(" compiler option in gcc), you can see the string literals in the "),a("code",[e._v(".rodata")]),e._v(" section. In this context, rodata means “read-only data” - such data is available for the entire lifetime of the programme.")]),a("h3",{attrs:{id:"string-literals-in-memory"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#string-literals-in-memory","aria-hidden":"true"}},[e._v("#")]),e._v(" String Literals in Memory")]),a("p",[e._v("String literal data is placed into memory by the loader - the portion of the operating system which reads the executable file from the disk and initializes memory.")]),a("p",[e._v("The loader knows what to write for the string literals (and where they should go in memory) because the compiler writes information into the executable file describing the contents of the data section.")]),a("p",[e._v("After the loader finishes initializing memory, it marks the read-only portions of the static data section as non-writeable in the page table - the structure that the operating system maintains to describe the program’s memory to the hardware.")]),a("h3",{attrs:{id:"write-attempt-consequences"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#write-attempt-consequences","aria-hidden":"true"}},[e._v("#")]),e._v(" Write Attempt - Consequences")]),a("p",[e._v("Attempting to write to a read-only portion of memory is similar to writing to an invalid region of memory. It causes the hardware to trap into the operating system, transferring execution control from the programme to the OS kernel.")]),a("p",[e._v("Conceptually, the hardware takes the execution arrow out of the program, and puts it into a particular function in the OS, noting where the execution arrow was in case the OS wants to return control to the program. The OS then sees that the program was attempting to access memory in invalid ways, and kills it with a segmentation fault.")]),a("h2",{attrs:{id:"references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#references","aria-hidden":"true"}},[e._v("#")]),e._v(" References")]),a("p",[a("a",{attrs:{href:"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf#%5B%7B%22num%22%3A425%2C%22gen%22%3A0%7D%2C%7B%22name%22%3A%22XYZ%22%7D%2C-27%2C816%2Cnull%5D",target:"_blank",rel:"noopener noreferrer"}},[e._v("ISO/IEC definition of string")])])])}],!1,null,null,null);t.default=i.exports}}]);